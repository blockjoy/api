syntax="proto3";

package blockjoy.api.v1;

import "messages.proto";

enum NodeStatus {
    UndefinedNodeStatus = 0;
    Consensus = 1;
    Syncing = 2;
}

enum NodeType {
    UndefinedNodeType = 0;
    API = 1;
    ETL = 2;
    Miner = 3;
    Validator = 4;
}

enum VmStatus {
    UndefinedVmStatus = 0;
    Starting = 1;
    Started = 2;
    Stopping = 3;
    Stopped = 4;
    Upgrading = 5;
    Upgraded = 6;
}

message VmImage {
    string version = 1;
    string blockchain = 2;
    NodeType node_type = 3;
    string url = 4;
}

message NodeInfo {
    Uuid id = 1;
    string name = 2;
    string ip = 3;
    VmStatus vm_status = 4;
    NodeStatus node_status = 5;
    int64 block_height = 6;
    string onchain_name = 7;
}

message NodeStart {}
message NodeStop {}
message NodeRestart {}
message NodeUpgrade {
    VmImage image = 1;
}
message NodeInfoUpdate {
    optional string name = 1;
}
message NodeInfoGet {}
message NodeGenericCommand {
    repeated Parameter params = 1;
}
message NodeCreate {
    string name = 1;
    VmImage image = 2;
}
message NodeDelete {}

message NodeCommand {
    Uuid node_id = 1;
    CommandMeta _meta = 2;

    oneof command {
        NodeStart start = 3;
        NodeStop stop = 4;
        NodeRestart restart = 5;
        NodeUpgrade upgrade = 6;
        NodeInfoUpdate update = 7;
        NodeInfoGet info_get = 8;
        NodeGenericCommand generic = 9;
        NodeCreate create = 10;
        NodeDelete delete = 11;
    };
}